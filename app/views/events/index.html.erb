<h1>East Bay DSA events</h1>

<p>Want to learn more about East Bay DSA? Attend one of our many events in
  the area to find out how you can get involved in improving the lives
  of working people.</p>

<%= month_calendar events: @events do |date, events| %>
  <span class='simple-calendar--date-wrapper'>
    <span class='simple-calendar--date'>
      <%= date.day %>
    </span>
  </span>

  <div class='simple-calendar--events'>
    <% events.each do |event| %>
      <%= link_to event_path(event, slug: event.slug), class: 'simple-calendar--events--event' do %>
        <span class='simple-calendar--events--event-title'><%= event.name %><span>
        <br />
        <span class='simple-calendar--events--event-time'><%= format_time_range_short event.start_time, event.end_time %></span>
      <% end %>
    <% end %>
  </div>
<% end %>

<% content_for :schema do %>
  <script type="application/ld+json">
    [
      {% for event in page.calendar.events_upcoming %}
        {% if event.name and event.event.is_location? and event.event.venue_name %}
          {
            "@context": "http://schema.org",
            "@type": "Event",
            "name": "{{ event.name }}",
            "startDate": "{{ event.event.local_start_at | date: '%Y-%m-%dT%H:%M'}}-08:00",
            "endDate": "{{ event.event.local_end_at | date: '%Y-%m-%dT%H:%M'}}-08:00",
            "location": {
              "@type": "Place",
              "name": "{{ event.event.venue_name }}",
              "address": {
                "@type": "PostalAddress",
                "streetAddress": "{{ event.event.venue_address.address1 }}",
                "addressLocality": "{{ event.event.venue_address.city }}",
                "postalCode": "{{ event.event.venue_address.zip }}",
                "addressRegion": "{{ event.event.venue_address.state }}",
                "addressCountry": "{{ event.event.venue_address.country_code }}"
              }
            }{% if event.has_meta_image? %},
            "image": "{{ event.meta_image_url }}"{% endif %}{% if event.excerpt %},
            "description": "{{ event.excerpt }}"{% endif %}
          }
          {% if forloop.last == false %},{% endif %}
        {% endif %}
      {% endfor %}
    ]
  </script>
<% end %>
